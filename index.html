<!DOCTYPE html>
<html>
<head>
  <title>Grades Calculator</title>
  <style>
    body {
      background-color: #222;
      color: #eee;
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .container {
      background-color: #333;
      padding: 20px;
      border-radius: 10px;
    }

    h1 {
      margin-bottom: 20px;
    }

    input[type="text"] {
      width: 200px;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #555;
      border-radius: 5px;
    }

    button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #45a049;
    }

    .result {
      margin-top: 20px;
      display: none;
    }

    .result p {
      margin-bottom: 5px;
    }

    .error {
      color: red;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Grades Calculator</h1>
    <form>
      <label for="prelim">Preliminary Grade:</label>
      <input type="text" id="prelim" name="prelim">

      <button type="submit" id="calculateBtn">Calculate</button>
    </form>

    <div id="error" class="error"></div>

    <div id="result" class="result">
      <p>Preliminary Grade: <span id="prelimGrade"></span></p>
      <p>Required Midterm Grade: <span id="midtermGrade"></span></p>
      <p>Required Final Grade: <span id="finalGrade"></span></p>
      <p id="passMessage"></p>
      <p id="deansMessage"></p>
    </div>
  </div>

  <py-script>
    from pyscript import Element

    def reset_result():
      """Function to reset the result display and error message."""
      Element("result").element.style.display = "none"  # Hide the result section
      Element("error").element.innerHTML = ""  # Clear error message
      Element("prelimGrade").element.innerHTML = ""
      Element("midtermGrade").element.innerHTML = ""
      Element("finalGrade").element.innerHTML = ""
      Element("passMessage").element.innerHTML = ""
      Element("deansMessage").element.innerHTML = ""

    def calculate_grade(event):
      event.preventDefault()  # Prevent the form from refreshing the page
      reset_result()  # Reset any previous result when recalculating

      try:
        prelim = float(Element("prelim").element.value)
      except ValueError:
        Element("error").element.innerHTML = "Please enter a valid prelim grade."
        return

      passing_grade = 75
      deans_lister_grade = 90
      prelim_percent = 0.20
      midterm_percent = 0.30
      final_percent = 0.50

      # Validate prelim grade
      if prelim < 0 or prelim > 100:
        Element("error").element.innerHTML = "Please enter a valid prelim grade between 0 and 100."
        return

      # Clear error message if valid prelim is entered
      Element("error").element.innerHTML = ""

      # Calculate required grades
      current_total = prelim * prelim_percent
      required_total = passing_grade - current_total

      if required_total > 0:
        required_midterm_and_final = required_total / (midterm_percent + final_percent)
        pass_message = "It is difficult to pass, as the required grades are very high." if required_midterm_and_final > 90 else "You have a chance to pass!"
      else:
        required_midterm_and_final = 0
        pass_message = "Your current grade is high enough to pass!"

      # Calculate for Dean's Lister
      if prelim >= deans_lister_grade:
        deans_message = "You already qualify for Dean's Lister based on your Prelim grade!"
      else:
        required_deans_total = deans_lister_grade - current_total
        required_deans_midfinal = required_deans_total / (midterm_percent + final_percent)
        if required_deans_midfinal > 100:
          deans_message = "The required grade is above 100%."
        else:
          deans_message = f"The required grade for you to be a Deanâ€™s Lister is {required_deans_midfinal:.2f}% (midterm) and {required_deans_midfinal:.2f}% (finals)."

      # Update result display
      Element("prelimGrade").element.innerHTML = f"{prelim:.2f}%"
      Element("midtermGrade").element.innerHTML = f"{required_midterm_and_final:.2f}%"
      Element("finalGrade").element.innerHTML = f"{required_midterm_and_final:.2f}%"
      Element("passMessage").element.innerHTML = pass_message
      Element("deansMessage").element.innerHTML = deans_message

      # Show result section
      Element("result").element.style.display = "block"

    Element("calculateBtn").element.onclick = calculate_grade
  </py-script>
</body>
</html>
